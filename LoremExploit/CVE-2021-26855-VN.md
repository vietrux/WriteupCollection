

# Tôi đã khai thác và lấy hơn 100 bản ghi mật khẩu từ một hệ thống lớn của Việt Nam như thế nào?

Trong những năm gần đây, các mối đe dọa trên mạng đã trở nên tinh vi và nguy hiểm hơn, nhắm mục tiêu vào nhiều khía cạnh khác nhau của các tổ chức, bao gồm dữ liệu nhạy cảm và cơ sở hạ tầng quan trọng. Một lỗ hổng nghiêm trọng được phát hiện gần đây trong Microsoft Exchange Server, CVE-2021-26855, đã khiến các chuyên gia bảo mật lo ngại đáng kể do tác động tiềm ẩn mà lỗ hổng này có thể gây ra đối với các tổ chức. Báo cáo này nhằm cung cấp tổng quan chi tiết về lỗ hổng CVE-2021-26855 và các bước cần thiết để giảm thiểu rủi ro khai thác.
## Tổng quan về lỗ hổng CVE-2021-26855

CVE-2021-26855 là một lỗ hổng thực thi mã từ xa trong Microsoft Exchange Server, cho phép kẻ tấn công thực thi mã tùy ý trên các máy chủ dễ bị tấn công. Lỗ hổng bảo mật tồn tại do một lỗ hổng trong thành phần Exchange Control Panel (ECP), không thể xác thực chính xác đầu vào của người dùng. Bằng cách gửi một yêu cầu được chế tạo đặc biệt đến máy chủ dễ bị tấn công, kẻ tấn công có thể khai thác lỗ hổng này để thực thi mã tùy ý với các đặc quyền HỆ THỐNG.
## Khai thác CVE-2021-26855

Vào ngày 2.3.2023, chúng tôi phát hiện ra rằng Microsoft Exchange Server của hệ thống lớn ở Việt Nam tồn tại lỗ hổng và chúng tôi đã giành được quyền thực thi mã từ xa (RCE) thông qua việc khai thác CVE-2021-26855. Chúng tôi đã có quyền truy cập vào máy chủ bằng cách gửi request HTTP đến máy chủ. Request chứa dữ liệu được tạo thủ công bỏ qua quá trình xác thực thành phần ECP, cho phép chúng tôi thực thi mã tùy ý với các đặc quyền Admin.

Sau khi đạt được RCE, chúng tôi đã tiến hành tải một backdoor lên thư mục aspnet_client, cho phép chúng duy trì kết nối trên máy chủ. Vì máy chủ đang chạy trên Windows và chúng tôi không thể tương tác trực tiếp với môi truờng desktop nên việc truy cập dữ liệu từ tài khoản của mỗi người dùng là một thách thức. Để khắc phục điều này, chúng tôi đã chèn mã giống như keylogger vào trang đăng nhập của hệ thống và đợi người dùng mắc bẫy để đánh cắp thông tin đăng nhập nhạy cảm. Điều này cho phép chúng tôi có quyền truy cập vào dữ liệu nhạy cảm, ảnh hưởng đến tính bảo mật và tính toàn vẹn của hệ thống.
## Đánh giá tác động

Tác động của việc khai thác CVE-2021-26855 là rất lớn, với việc chúng tôi có quyền truy cập vào dữ liệu nhạy cảm và ảnh hưởng đến tính bảo mật và tính toàn vẹn của hệ thống. Lỗ hổng cho phép chúng tôi thực thi mã tùy ý với các đặc quyền Admin, giúp chúng tôi có thể kiểm soát hoàn toàn máy chủ. Các hành động của chúng tôi, bao gồm tải lên một cửa hậu và đánh cắp thông tin đăng nhập, đã khiến tổ chức gặp rủi ro về uy tín, tài chính và pháp lý.
## Phân tích kỹ thuật

Việc khai thác CVE-2021-26855 của chúng tôi được thực hiện thông qua một yêu cầu HTTP được tạo thủ công, bỏ qua xác thực thành phần ECP và dẫn đến RCE. Sau đó, chúng tôi tiến hành tải một backdoor lên thư mục aspnet_client và chèn mã giống key-logger vào trang đăng nhập của hệ thống. Điều này cho phép chúng tôi thực hiện các cuộc tấn công lừa đảo và giành quyền truy cập vào dữ liệu nhạy cảm.
## Khắc phục

Để giảm thiểu rủi ro khai thác thêm, chúng tôi đã thực hiện các bước sau:

- Đã áp dụng các bản vá bảo mật mới nhất do Microsoft phát hành để giải quyết lỗ hổng CVE-2021-26855.
- Đã tiến hành xem xét kỹ lưỡng nhật ký hệ thống của chúng tôi để xác định bất kỳ hoạt động bất thường nào và triển khai các khả năng giám sát nâng cao.
- Đã xóa backdoor do chúng tôi tải lên và tiến hành đánh giá bảo mật toàn diện của hệ thống để xác định bất kỳ lỗ hổng nào khác.
- Đặt lại tất cả mật khẩu người dùng và triển khai xác thực đa yếu tố.
- Cung cấp đào tạo nhận thức người dùng để ngăn chặn các cuộc tấn công lừa đảo trong tương lai.

## Bài học Kinh nghiệm và Kiến nghị

Việc khai thác CVE-2021-26855 đã nêu bật tầm quan trọng của việc vá lỗ hổng và quản lý lỗ hổng kịp thời, giám sát bảo mật chủ động và đào tạo nâng cao nhận thức cho người dùng. Để ngăn các sự cố tương tự xảy ra trong tương lai, chúng tôi khuyên các tổ chức nên thực hiện các bước sau:

- Đảm bảo rằng tất cả các hệ thống đều được cập nhật với các bản vá và cập nhật bảo mật mới nhất.
- Tiến hành quét lỗ hổng thường xuyên và kiểm tra thâm nhập để xác định các lỗ hổng tiềm ẩn và giải quyết chúng kịp thời.
- Thực hiện các khả năng giám sát an ninh nâng cao để phát hiện và ứng phó với các sự cố an ninh trong thời gian thực.
- Triển khai xác thực đa yếu tố để cung cấp thêm một lớp bảo mật và bảo vệ chống lại hành vi trộm cắp thông tin xác thực.
- Cung cấp đào tạo nhận thức bảo mật thường xuyên cho nhân viên để giáo dục họ về các mối đe dọa mới nhất và các phương pháp hay nhất để bảo vệ dữ liệu và hệ thống nhạy cảm.

## Phần kết luận

Lỗ hổng CVE-2021-26855 trong Microsoft Exchange Server nêu bật tầm quan trọng của việc vá lỗi kịp thời, quản lý lỗ hổng và giám sát bảo mật chủ động. Lỗ hổng này cho phép kẻ tấn công có quyền truy cập vào dữ liệu nhạy cảm và xâm phạm tính bảo mật và tính toàn vẹn của hệ thống. Các tổ chức phải thực hiện các biện pháp chủ động để giải quyết kịp thời các lỗ hổng, triển khai các khả năng giám sát bảo mật nâng cao và cung cấp đào tạo nâng cao nhận thức bảo mật thường xuyên cho nhân viên. Bằng cách thực hiện các bước này, các tổ chức có thể bảo vệ tốt hơn hệ thống và dữ liệu của họ khỏi các mối đe dọa trên mạng.

