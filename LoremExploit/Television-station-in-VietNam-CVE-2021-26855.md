# How did I exploit and retrieve over 100 records of passwords from a major television station in Vietnam?

In recent years, cyber threats have become more sophisticated and dangerous, targeting various aspects of organizations, including sensitive data and critical infrastructure. A critical vulnerability that was recently discovered in Microsoft Exchange Server, CVE-2021-26855, has caused significant concern among security experts due to the potential impact it could have on organizations. This report aims to provide a detailed overview of the CVE-2021-26855 vulnerability and the steps required to mitigate the risk of exploitation.
## Overview of the CVE-2021-26855 Vulnerability

CVE-2021-26855 is a remote code execution vulnerability in Microsoft Exchange Server that allows attackers to execute arbitrary code on vulnerable servers. The vulnerability exists due to a flaw in the Exchange Control Panel (ECP) component, which fails to properly validate user input. By sending a specially crafted request to the vulnerable server, an attacker can exploit this flaw to execute arbitrary code with SYSTEM privileges.
## Exploitation of CVE-2021-26855

On 2.3.2023, we discovered that Microsoft Exchange Server of a large television station in Vietnam had been compromised, and we had gained remote code execution (RCE) through the exploitation of CVE-2021-26855. We gained access to the server by sending a malicious HTTP request to the vulnerable server. The request contained crafted data that bypassed ECP component validation, allowing us to execute arbitrary code with SYSTEM privileges.

After gaining RCE, we proceeded to upload an .aspx backdoor to the aspnet_client folder, enabling them to maintain persistence on the server. As the server was running on Windows and we could not directly interact with the desktop, it was challenging to access data from each user's account. To overcome this, we injected a key-logger-like code into the login page of the system and carried out phishing attacks to steal sensitive login credentials. This enabled us to gain access to sensitive data, compromising the confidentiality and integrity of the system.
## Impact Assessment

The impact of the exploitation of CVE-2021-26855 was significant, with us gaining access to sensitive data and compromising the confidentiality and integrity of the system. The vulnerability allowed us to execute arbitrary code with SYSTEM privileges, making it possible to take full control of the vulnerable server. Our actions, including uploading a backdoor and stealing login credentials, exposed the organization to reputational, financial, and legal risks.
## Technical Analysis

Our exploitation of CVE-2021-26855 was carried out through a crafted HTTP request, bypassing ECP component validation, and leading to RCE. We then proceeded to upload a backdoor to the aspnet_client folder and injected key-logger-like code into the login page of the system. This enabled us to carry out phishing attacks and gain access to sensitive data.
## Remediation

To mitigate the risk of further exploitation, we took the following steps:

- Applied the latest security patches released by Microsoft to address the CVE-2021-26855 vulnerability.
- Conducted a thorough review of our system logs to identify any unusual activity and implemented enhanced monitoring capabilities.
- Removed the backdoor uploaded by us and carried out a thorough security assessment of the system to identify any other vulnerabilities.
- Reset all user passwords and implemented multi-factor authentication.
- Provided user awareness training to prevent future phishing attacks.

## Lessons Learned and Recommendations

The exploitation of CVE-2021-26855 highlighted the importance of timely patching and vulnerability management, proactive security monitoring, and user awareness training. To prevent similar incidents from occurring in the future, we recommend that organizations take the following steps:

- Ensure that all systems are up to date with the latest security patches and updates.
- Conduct regular vulnerability scans and penetration testing to identify potential vulnerabilities and address them promptly.
- Implement enhanced security monitoring capabilities to detect and respond to security incidents in real-time.
- Implement multi-factor authentication to provide an additional layer of security and protect against credential theft.
- Provide regular security awareness training to employees to educate them on the latest threats and best practices to protect sensitive data and systems.

## Conclusion

The CVE-2021-26855 vulnerability in Microsoft Exchange Server highlighted the importance of timely patching, vulnerability management, and proactive security monitoring. This vulnerability allowed attackers to gain access to sensitive data and compromise the confidentiality and integrity of the system. Organizations must take proactive measures to address vulnerabilities promptly, implement enhanced security monitoring capabilities, and provide regular security awareness training to employees. By taking these steps, organizations can better protect their systems and data from cyber threats.
